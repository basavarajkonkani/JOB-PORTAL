# Implementation Plan

- [x] 1. Set up project structure and development environment
  - Initialize Next.js project with TypeScript and TailwindCSS
  - Set up Express backend with TypeScript configuration
  - Configure PostgreSQL database with Docker Compose for local development
  - Set up Redis for caching
  - Create environment variable configuration files (.env.example)
  - Configure ESLint, Prettier, and Git hooks
  - _Requirements: All (foundation for entire system)_

- [x] 2. Implement database schema and migrations
  - Create migration files for users, candidate_profiles, recruiter_profiles, orgs tables
  - Create migration files for jobs, applications tables
  - Create migration files for resumes, resume_versions tables
  - Create migration files for events, metrics_cache tables
  - Add indexes on foreign keys and search fields (job title, location, skills)
  - Write seed data for development (sample users, jobs, orgs)
  - _Requirements: 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 12.1_

- [x] 3. Build authentication system
  - [x] 3.1 Implement User model and database operations
    - Create User entity with CRUD operations
    - Implement password hashing with bcrypt
    - _Requirements: 7.1_
  - [x] 3.2 Create JWT authentication middleware
    - Implement token generation (access + refresh tokens)
    - Create auth middleware for protected routes
    - Implement token refresh endpoint
    - _Requirements: 7.1_
  - [x] 3.3 Build auth API endpoints
    - POST /api/auth/signup endpoint with validation
    - POST /api/auth/signin endpoint with rate limiting
    - POST /api/auth/refresh endpoint
    - _Requirements: 7.1_
  - [x] 3.4 Create frontend auth forms and flows
    - Build SignUp and SignIn components
    - Implement auth context and token storage
    - Add protected route wrapper component
    - _Requirements: 7.1_

- [x] 4. Implement User Service and profile management
  - [x] 4.1 Create CandidateProfile model and operations
    - Build CandidateProfile entity with skills, experience, education fields
    - Implement profile CRUD operations
    - _Requirements: 3.1, 7.2_
  - [x] 4.2 Create RecruiterProfile and Org models
    - Build RecruiterProfile and Org entities
    - Implement org-recruiter relationship management
    - _Requirements: 5.1_
  - [x] 4.3 Build profile API endpoints
    - GET /api/candidate/profile endpoint
    - PUT /api/candidate/profile endpoint with validation
    - GET /api/recruiter/profile endpoint
    - _Requirements: 3.5, 7.4_
  - [x] 4.4 Create frontend profile components
    - Build CandidateProfile form with skills, experience, education sections
    - Build RecruiterProfile form
    - Add profile completion indicator
    - _Requirements: 3.5, 7.4_

- [x] 5. Build Resume Service with parsing and AI improvements
  - [x] 5.1 Implement file upload and storage
    - Set up S3 client configuration
    - Create POST /api/candidate/resume/upload endpoint with file validation
    - Implement secure file storage with unique naming
    - _Requirements: 3.1_
  - [x] 5.2 Build resume parsing functionality
    - Integrate pdf-parse library for PDF extraction
    - Integrate mammoth library for DOCX extraction
    - Create POST /api/candidate/resume/parse endpoint
    - Implement structured data extraction (skills, experience, education)
    - _Requirements: 3.2_
  - [x] 5.3 Create Resume and ResumeVersion models
    - Build Resume and ResumeVersion entities
    - Implement version management operations
    - Create GET /api/candidate/resumes endpoint
    - _Requirements: 3.4_
  - [x] 5.4 Build frontend resume upload and editor
    - Create file upload component with drag-and-drop
    - Build parsed resume editor with sections for skills, experience, education
    - Add resume version selector
    - _Requirements: 3.1, 3.5, 7.2_

- [x] 6. Implement AI Service with Pollinations integration
  - [x] 6.1 Create AI Service core infrastructure
    - Build Pollinations API client with text and image URL construction
    - Implement caching layer with Redis (prompt hash as key)
    - Add retry logic with exponential backoff
    - Implement circuit breaker for API failures
    - _Requirements: 8.2, 8.3, 8.4, 8.5, 11.1, 11.5_
  - [x] 6.2 Build AI prompt templates and generators
    - Create prompt templates for fit summary, cover letter, resume improvement, JD generation
    - Implement prompt builder functions with deterministic parameters
    - _Requirements: 8.2_
  - [x] 6.3 Implement AI text generation methods
    - Create generateFitSummary method
    - Create generateCoverLetter method
    - Create improveResumeBullets method
    - Create generateJD method
    - Create rankCandidates method
    - Create generateScreeningQuestions method
    - _Requirements: 2.3, 2.5, 3.3, 5.2, 6.2, 6.3, 6.4_
  - [x] 6.4 Implement AI image generation
    - Create generateImage method with Pollinations image URL construction
    - Add image URL caching with 24-hour TTL
    - _Requirements: 2.2, 5.5_
  - [x] 6.5 Build AI API endpoints
    - POST /api/ai/fit-summary endpoint
    - POST /api/ai/cover-letter endpoint
    - POST /api/ai/resume-improve endpoint
    - POST /api/ai/jd-generate endpoint
    - POST /api/ai/shortlist endpoint
    - POST /api/ai/screening-questions endpoint
    - POST /api/ai/image endpoint
    - _Requirements: 2.3, 2.5, 3.3, 5.2, 5.5, 6.2, 6.3, 6.4_
  - [x] 6.6 Create AI Copilot frontend component
    - Build collapsible AICopilotPanel component
    - Implement structured response rendering (summary, items, actions)
    - Add loading states and error handling with fallbacks
    - _Requirements: 8.1, 8.5, 11.1, 11.2_

- [x] 7. Build Job Service with search and filtering
  - [x] 7.1 Create Job model and operations
    - Build Job entity with all fields (title, level, location, type, compensation, etc.)
    - Implement job CRUD operations
    - Add job status management (draft, active, closed)
    - _Requirements: 1.1, 5.6_
  - [x] 7.2 Implement job search and filtering
    - Build search query builder with filters (title, level, location, remote)
    - Add pagination logic (20 jobs per page)
    - Create database indexes for search performance
    - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6_
  - [x] 7.3 Build public job API endpoints
    - GET /api/jobs endpoint with search and filter parameters
    - GET /api/jobs/:id endpoint with optional user context
    - _Requirements: 1.1, 2.1_
  - [x] 7.4 Create frontend job search components
    - Build JobSearchPage with filter sidebar (title, level, location, remote)
    - Implement job results grid with pagination
    - Add save and share functionality
    - _Requirements: 1.1, 1.2, 1.3, 1.4, 1.5, 1.6, 2.4_
  - [x] 7.5 Build JobDetailPage component
    - Create job detail layout with all job information
    - Integrate AI fit summary display
    - Add hero image with Pollinations URL and fallback
    - Implement apply button with modal
    - _Requirements: 2.1, 2.2, 2.3, 2.4_

- [x] 8. Implement Application Service and tracking
  - [x] 8.1 Create Application model and operations
    - Build Application entity with status, notes, AI score fields
    - Implement application CRUD operations
    - _Requirements: 4.1_
  - [x] 8.2 Build application API endpoints
    - POST /api/applications endpoint with validation
    - GET /api/applications endpoint for candidate's applications
    - PUT /api/applications/:id endpoint for notes and status updates
    - _Requirements: 4.1, 4.2, 4.3, 4.4_
  - [x] 8.3 Create frontend application components
    - Build application submission modal with cover letter integration
    - Create ApplicationsTracker component with timeline view
    - Add application notes editor
    - Implement status badges and reminders
    - _Requirements: 4.1, 4.2, 4.3, 4.4, 4.5_

- [x] 9. Build Recruiter JD Wizard with AI assistance
  - [x] 9.1 Create recruiter job API endpoints
    - POST /api/recruiter/jobs endpoint with AI JD generation
    - PUT /api/recruiter/jobs/:id endpoint
    - DELETE /api/recruiter/jobs/:id endpoint (soft delete to closed status)
    - _Requirements: 5.1, 5.2, 5.4, 5.6_
  - [x] 9.2 Build JD Wizard frontend component
    - Create multi-step form for job notes input
    - Integrate AI JD generation with loading state
    - Build JD editor with rich text formatting
    - Add hero image generation trigger
    - Implement publish action
    - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5, 5.6_
  - [x] 9.3 Create RecruiterDashboard component
    - Build dashboard with open roles summary
    - Add pipeline statistics display
    - Implement quick actions (create job, view applicants)
    - _Requirements: 5.1_

- [x] 10. Implement Candidate Shortlist with AI ranking
  - [x] 10.1 Create shortlist API endpoint
    - GET /api/recruiter/jobs/:id/candidates endpoint
    - Integrate AI ranking and rationale generation
    - Add filtering and sorting options
    - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5_
  - [x] 10.2 Build CandidateShortlist frontend component
    - Create candidate list with AI scores and rationale
    - Display screening questions for each candidate
    - Add filter and sort controls
    - Implement candidate detail modal
    - _Requirements: 6.1, 6.2, 6.3, 6.4, 6.5_

- [x] 11. Build Candidate Dashboard and onboarding flow
  - [x] 11.1 Create CandidateDashboard component
    - Build recommended jobs section based on profile
    - Add recent activity timeline
    - Display profile completion indicator
    - _Requirements: 7.5_
  - [x] 11.2 Implement onboarding flow
    - Create onboarding wizard with steps (upload resume, confirm profile)
    - Integrate AI profile suggestions
    - Add skip and complete actions
    - Redirect to dashboard on completion
    - _Requirements: 7.1, 7.2, 7.3, 7.4, 7.5_

- [x] 12. Implement Analytics Service and tracking
  - [x] 12.1 Create analytics event tracking
    - Build event logging infrastructure
    - Create POST /api/analytics/event endpoint
    - Implement client-side event tracking hooks
    - _Requirements: 12.1, 12.2, 12.3_
  - [x] 12.2 Build metric calculation methods
    - Implement D1 activation rate calculation
    - Implement apply conversion rate calculation
    - Implement recruiter time-to-publish calculation
    - Create GET /api/analytics/metrics endpoint (admin only)
    - _Requirements: 12.4, 12.5_
  - [x] 12.3 Add analytics tracking to key user flows
    - Track page visits, job views, applications
    - Track AI copilot usage (sessions, artifacts, acceptance)
    - Track recruiter JD creation flow
    - _Requirements: 12.1, 12.2, 12.3_

- [x] 13. Implement error handling and graceful degradation
  - [x] 13.1 Create error handling middleware and utilities
    - Build centralized error handler middleware
    - Create ErrorResponse type and error factory functions
    - Implement error logging with context
    - _Requirements: 11.4_
  - [x] 13.2 Add graceful degradation for AI failures
    - Implement fallback UI for AI text generation failures
    - Add default placeholder images for AI image failures
    - Create manual input alternatives when AI is unavailable
    - _Requirements: 8.5, 11.1, 11.2_
  - [x] 13.3 Implement rate limiting
    - Add rate limiting middleware for auth endpoints (5 attempts per 15 min)
    - Add rate limiting for AI endpoints (per user and per IP)
    - Return 429 status with retry-after header
    - _Requirements: 11.3_
  - [x] 13.4 Build frontend error boundaries and fallbacks
    - Create ErrorBoundary component for React error catching
    - Build error pages (404, 500, 503)
    - Add toast notifications for user-facing errors
    - _Requirements: 11.1, 11.2_

- [x] 14. Implement performance optimizations
  - [x] 14.1 Add caching layer
    - Implement Redis caching for user sessions (30 min TTL)
    - Cache job search results (5 min TTL)
    - Cache AI responses (1 hour for text, 24 hour for images)
    - _Requirements: 9.1, 9.2_
  - [x] 14.2 Optimize database queries
    - Add database indexes on foreign keys and search fields
    - Implement connection pooling
    - Optimize complex queries with joins
    - _Requirements: 9.1_
  - [x] 14.3 Implement frontend performance optimizations
    - Add code splitting by route
    - Implement lazy loading for below-fold content
    - Optimize images with Next.js Image component
    - Add loading skeletons for async content
    - _Requirements: 9.1, 9.3_

- [x] 15. Implement accessibility features
  - [x] 15.1 Add ARIA labels and semantic HTML
    - Use semantic HTML elements (nav, main, article, aside)
    - Add ARIA labels for icon buttons and complex widgets
    - Implement ARIA live regions for dynamic content
    - _Requirements: 10.2, 10.3, 10.4, 10.5_
  - [x] 15.2 Implement keyboard navigation
    - Ensure all interactive elements are keyboard accessible
    - Add visible focus indicators
    - Implement skip navigation links
    - Handle escape key for modals and dropdowns
    - _Requirements: 10.2, 10.4_
  - [x] 15.3 Ensure color contrast compliance
    - Audit and fix color contrast ratios (4.5:1 for normal text)
    - Add high contrast focus indicators
    - Provide text alternatives for AI-generated images
    - _Requirements: 10.1, 10.5_

- [x] 16. Implement SEO optimizations
  - [x] 16.1 Add server-side rendering for public pages
    - Configure Next.js SSR for job listings and detail pages
    - Implement getServerSideProps for dynamic job data
    - _Requirements: 9.3_
  - [x] 16.2 Add meta tags and structured data
    - Create meta tag component with title, description, og:tags
    - Implement JSON-LD structured data for job postings
    - Add canonical URLs
    - _Requirements: 9.3_
  - [x] 16.3 Create sitemap and robots.txt
    - Generate XML sitemap for job listings
    - Configure robots.txt
    - _Requirements: 9.3_

- [x] 17. Set up deployment and CI/CD pipeline
  - [x] 17.1 Create Docker configuration
    - Write Dockerfile for backend service
    - Write docker-compose.yml for local development
    - Configure production Docker image optimization
    - _Requirements: All (deployment foundation)_
  - [x] 17.2 Set up CI/CD pipeline
    - Configure GitHub Actions workflow
    - Add linting, type checking, and test steps
    - Implement automated deployment to staging
    - Add smoke tests for production deployment
    - _Requirements: All (deployment automation)_
  - [x] 17.3 Configure monitoring and logging
    - Set up error tracking with Sentry
    - Configure application monitoring
    - Set up log aggregation
    - Create uptime monitoring checks
    - _Requirements: 11.4_

- [x] 18. Write integration tests for critical flows
  - Write integration tests for auth flow (signup, signin, refresh)
  - Write integration tests for job search and application flow
  - Write integration tests for resume upload and parsing
  - Write integration tests for AI endpoints with mocked Pollinations responses
  - Write integration tests for recruiter JD creation and shortlist
  - _Requirements: All (quality assurance)_

- [x] 19. Write end-to-end tests for user journeys
  - Write E2E test for candidate onboarding (signup → upload resume → view profile)
  - Write E2E test for job application (search → view detail → apply with AI cover letter)
  - Write E2E test for recruiter JD creation (login → create job with AI → publish)
  - Write E2E test for shortlist generation (view applicants → request AI ranking)
  - _Requirements: All (quality assurance)_
